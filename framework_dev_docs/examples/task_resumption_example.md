# Example Usage: Task Resumption Add-on

This document demonstrates how a user would ensure the "Task Resumption Add-on" is utilized by Task AIs.

## 1. Scenario
A user is defining a project that will be planned by a Planning AI using the MPS v0.3+ framework. They want all Task AIs generated by this plan to use the Task Resumption Add-on.

## 2. User's Setup for the Planning AI

The user performs these steps in their target repository *before* invoking the Planning AI:

**A. Prepare Add-on File:**
   Ensure the content of the canonical `task_resumption_addon.txt` (from this framework's `/prompts/add_ons/task_resumption_addon.txt`) is copied into `/prompts/add_ons/task_resumption_addon.txt` within the *target repository*.

**B. Prepare Base IEP File:**
   Ensure the content of the canonical `Base_IEP.txt` (from this framework's `/prompts/iep/Base_IEP.txt`) is copied into `/prompts/iep/Base_IEP.txt` within the *target repository*.

**C. Craft the Main Spawn Prompt for the Planning AI:**
   In their main spawn prompt file (e.g., `/prompts/p_project_phoenix_spawn.md` in the target repository), the user includes:
    1.  Their project-specific request (e.g., "Refactor the authentication module...").
    2.  The `[[USER_ADDON_SELECTION]]` block, selecting the add-on:
        ```text
        [[USER_ADDON_SELECTION]]
        [x] task_resumption_addon.txt
        [[END USER_ADDON_SELECTION]]
        ```
    3.  The full content of the canonical `/prompts/Master_Prompt_Segment.md` (v0.3+), with its internal `[[USER PATH CONFIGURATION]]` block edited by the user to define output paths for the "Project Phoenix" plan.

**Illustrative Snippet of User's Spawn Prompt (e.g., `/prompts/p_project_phoenix_spawn.md`):**
```text
Hello Planning AI,

Please plan the refactoring of the authentication module for Project Phoenix.
The key requirements are:
1.  Implement OAuth2 using the 'authlib' library.
2.  Ensure all existing unit tests for authentication still pass.
3.  Update the API documentation in `docs/api/auth.md`.
(Other project details...)

[[USER_ADDON_SELECTION]]
[x] task_resumption_addon.txt
[[END USER_ADDON_SELECTION]]

--------------------------------------------------------------------------------------------------------------
[[USER PATH CONFIGURATION]]
# User has edited these paths for Project Phoenix outputs
Main Iteration Folder: project_phoenix_planning_outputs
Prompts Folder: prompts
Submodule Plan Destination: plans
Inter-AI Communication Folder: prompts/ipc
User-Specified Task Output Base Path: src/project_phoenix
[[END USER PATH CONFIGURATION]]

--------------------------------------------------------------------------------------------------------------
[[START OF MASTER PROMPT SEGMENT (v0.3.1 ...): AI Project Planning & Task Generation Instructions]]
(Full MPS v0.3.1+ text here)
[[END OF MASTER PROMPT SEGMENT...]]
```

## 3. Planning AI Behavior

*   The Planning AI parses the `[[USER_ADDON_SELECTION]]` block from the user's spawn prompt.
*   It reads the content of `/prompts/add_ons/task_resumption_addon.txt` (from the target repository, which the user set up).
*   When the Planning AI generates individual task prompts for "Project Phoenix" (e.g., `project_phoenix_planning_outputs/prompts/p1_t1_implement_oauth.txt`), it will append the full content of `task_resumption_addon.txt` to each of those task prompts, resolving placeholders like `[Actual Path to Submodule Plan Destination]` (which would become `project_phoenix_planning_outputs/plans` in this example).

## 4. Task AI Behavior (Illustrative)

A Task AI, when assigned a prompt like `project_phoenix_planning_outputs/prompts/p1_t1_implement_oauth.txt` (which now includes the Task Resumption Add-on instructions at the end):

*   **Normal Task Execution:** Proceeds with implementing OAuth2.
*   **Resumption Prompt Creation/Update:** Following the add-on's instructions, it creates/updates `project_phoenix_planning_outputs/plans/p1_t1_implement_oauth_resumption_prompt.txt` after each significant step or before pausing.
*   **IEP Commit:** The commit message for saving the resumption prompt includes the specified tag:
    ```
    Task-ID: p1_t1_implement_oauth.txt
    Status: In-Progress
    Summary: Updated resumption prompt after completing initial OAuth2 client setup.
    Files-Modified:
    - project_phoenix_planning_outputs/plans/p1_t1_implement_oauth_resumption_prompt.txt: Modified
    - src/project_phoenix/auth/oauth_client.py: Created
    Notes-To-Next-Jules:
    [TASK_RESUMPTION_PROMPT_STATUS]: Updated_At='project_phoenix_planning_outputs/plans/p1_t1_implement_oauth_resumption_prompt.txt'
    [RISK_ASSESSMENT]
    - Risk-Level: Low
    - Justification: Initial setup, stubs created.
    ```

This example shows how the configurable add-on mechanism allows users to enable specific behaviors like task resumption for all tasks within a planned project.
